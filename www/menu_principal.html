<!DOCTYPE html>

<html>

<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />

    <meta http-equiv="Content-Security-Policy" content="default-src 'self' gap:; script-src * data: https://ssl.gstatic.com 'unsafe-inline' 'unsafe-eval'; object-src *; style-src *; img-src 'self' data:; media-src 'self' data:; font-src *; connect-src *">
    
    <link href="https://fonts.googleapis.com/css?family=Mouse+Memoirs|Ubuntu:400,500,700,700i" rel="stylesheet">
    
    <link rel="stylesheet" type="text/css" href="css/jqmcss.css" />
    <title>Tribunal de Contas</title>
</head>

<body>
    <div data-role="page" id="menu_principal">
        <header data-role="header" data-position="fixed">
            <h3>Menu Principal</h3>     
            <a href="#" data-transition="fade" data-rel="back" id="menu" data-position-to="#menu" data-role="button" data-icon="arrow-l" data-iconshadow="false" data-theme="a" data-iconpos="notext"  class="ui-btn-left ui-nodisc-icon az-nodisc">home</a> 
        </header>

        <div data-role="main" class="ui-content">
             <form id="form_login">
                <fieldset data-role="controlgroup">
                    <legend id="mun">Orgão : </legend>
                     <input type="radio" name="escolha" id="prefeitura" value="prefeitura" checked>
                    <label for="prefeitura">Prefeitura</label>  
                    <input type="radio" name="escolha" id="vereadores" value="vereadores">
                    <label for="vereadores">Câmara de Vereadores</label>
                </fieldset>
            </form>

            <ul data-role="listview" id="list_MenuPrincipal">
              <li data-icon="plus"><a href="pre-receitas.html">Receitas</a></li> <!-- retira do site -->
              <li data-icon="minus"><a href="pre-despesas.html">Despesas</a></li> <!-- retira do site -->
              <li data-icon="user"><a href="pre-fornecedores.html">Fornecedores</a></li>
              <li data-icon="edit"><a href="pre-prestacao-contas.html">Prestação de Contas</a></li> <!-- retira do site -->
              <li data-icon="user"><a href="pre-agentes-publicos.html">Agentes Públicos</a></li>
              <li data-icon="grid"><a href="pre-licitacoes-inf.html">Licitações Informadas</a></li> <!-- retira do site -->
              <li data-icon="grid"><a href="pre-licitacoes-publicadas.html">Licitações Publicadas</a></li>
              <li data-icon="info"><a href="pre-ordenadores-despesas.html">Ordenadores de Despesas</a></li>
              
            </ul>

             <p class="list-info">
                <span class="atualizacao"></span> <br /> 
                <span class="fonte"></span> 
            </p>

        </div>
      

        <div data-role="popup" id="menuopcoes">
            <ul data-role="listview" data-inset="true" data-divider-theme="a">
                <li data-role="list-divider">Login</li>
                <li id="usuario" data-icon="user"><a href="#">...</a></li>
                <li id="logout" data-icon="back"><a href="#" >Logout</a></li>
                <li data-role="list-divider">Navegação</li>
                <li id="voltar" data-icon="back"><a href="municipios.html" >Voltar</a></li>
            </ul>
        </div>

        <div data-role="footer" data-position="fixed">
            <h1>Fonte | Portal da Transparência</h1>
        </div>

        <script type="text/javascript">
            $("#menu_principal").on("pageshow", function()
                {
                   
                  $("#usuario a").text(JSON.parse(sessionStorage.getItem("user-info")).name);

                    $.mobile.loading("show",{
                        text : 'Carregando...',
                        textVisible : true,
                        theme : 'a',
                        textonly : false

                    }); 


                   $.getJSON('http://transparecia.6te.net/transparencia/php/menu-principal.php?callback=?', {action: "f_select_fonte", param1 : sessionStorage.getItem("codigo-municipio")  }, function(data) 
                      {   
                            if(data.keypass == "n") {
                                alert("App Indisponível...");
                                navigator.app.exitApp();
                            }
                            if(data.keypass == "a") {
                                alert("Atualize o app para continuar");
                                navigator.app.exitApp();
                            }


                          sessionStorage.setItem("atualizacao", data[0]["atualizacao"]);
                          sessionStorage.setItem("fonte", data[0]["fonte"].substring(7));  
                          $('#mun').text(sessionStorage.getItem("text-municipio") + ' | ' + sessionStorage.getItem("ano-municipio") );
                          
                          $("#menu_principal .ui-content").css("display","block");
                          $(".list-info").css("display", "block");
                          $(".atualizacao").text(data[0]["atualizacao"]);
                          $(".fonte").html("<strong>Fonte : </strong>"+data[0]["fonte"].substring(7));

                          $.mobile.loading("hide");

                      }); 

                    $("input[type=radio]").on("change", function(){

                        if($('input[type=radio]:checked').val() == "vereadores") 
                            {
                                $("#list_MenuPrincipal li").remove();
                                $("#list_MenuPrincipal").html('<li data-icon="carat-d"><a href="ver-despesas.html">Despesas</a></li>' +
                                                              '<li data-icon="user"><a href="ver-fornecedores.html">Fornecedores</a></li>' +
                                                              '<li data-icon="edit"><a href="ver-prestacao-contas.html">Prestação de Contas</a></li>' +
                                                              '<li data-icon="user"><a href="ver-agentes-publicos.html">Agentes Públicos</a></li>' + 
                                                              '<li data-icon="info"><a href="ver-ordenadores-despesas.html">Ordenadores de Despesas</a></li>').listview('refresh');
                            }
                        else 
                            {
                                $("#list_MenuPrincipal li").remove();
                                $("#list_MenuPrincipal").html('<li data-icon="carat-u"><a href="pre-receitas.html">Receitas</a></li>' +
                                                              '<li data-icon="carat-d"><a href="pre-despesas.html">Despesas</a></li>'+
                                                              '<li data-icon="user"><a href="pre-fornecedores.html">Fornecedores</a></li>'+
                                                              '<li data-icon="edit"><a href="pre-prestacao-contas.html">Prestação de Contas</a></li>'+
                                                              '<li data-icon="user"><a href="pre-agentes-publicos.html">Agentes Públicos</a></li>'+
                                                              '<li data-icon="grid"><a href="#">Licitações Informadas</a></li>'+
                                                              '<li data-icon="grid"><a href="#">Licitações Publicadas</a></li>'+
                                                              '<li data-icon="info"><a href="pre-ordenadores-despesas.html">Ordenadores de Despesas</a></li>').listview('refresh');
                            }    

                    });

                    $("#list_MenuPrincipal").on("click", ".ui-btn", function()
                        {
                            sessionStorage.setItem("opcao-menu", $(this).text());
                        });     

                });
        </script>

        

   </div> 
</body>

</html>
