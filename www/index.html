<!DOCTYPE html>

<html>

<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
    

    <meta http-equiv="Content-Security-Policy" content="default-src 'self' gap:; script-src * data: https://ssl.gstatic.com 'unsafe-inline' 'unsafe-eval'; object-src *; style-src *; img-src 'self' data:; media-src 'self' data:; font-src *; connect-src *">
    
    
    <link href="https://fonts.googleapis.com/css?family=Mouse+Memoirs|Ubuntu:400,500,700,700i" rel="stylesheet">
    

    <link rel="stylesheet" type="text/css" href="css/jqmcss.css" />
    <title>Tribunal de Contas</title>


</head>

<body>
    <div data-role="page" id="index">
        <header data-role="header">
            <h3>Tribunal de Contas</h3>
        </header>

        <div data-role="main" class="ui-content">
            <p class="sumary">Login</p>
         
            <form id="form_login">
                <div data-role="fieldcontain" class="ui-hide-label">
                    <label for="textUser">Usuário: </label>
                    <input type="text" name="textUser" id="textUser" placeholder="Username"/>
                </div>
                <div data-role="fieldcontain" class="ui-hide-label">
                    <label for="textPassword">Senha: </label>
                    <input type="password" name="textPassword" id="textPassword" placeholder="Password"/>
                </div>
                
                <a href="municipios.html" class="ui-btn ui-btn-a ui-icon-check ui-btn-icon-left ui-corner-all" id="button1">Entrar</a>
                <a href="#" class="ui-btn ui-btn-a ui-icon-myicon ui-btn-icon-left ui-corner-all" id="button2">Entrar com facebook</a>

            </form>
        </div>
    

        <div data-role="footer" data-position="fixed">
            <h1></h1>
        </div>

        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/jquery.js"></script>
        <script type="text/javascript" src="js/jquerymobile.js"></script>
        <script type="text/javascript">
               

                $("#index").on("pageshow", function()
                  {
                       $("#button2").on("click", function()
                         {
                            facebookConnectPlugin.login(['email'],function(response)
                              {
                                
                                facebookConnectPlugin.api('me?fields=id,name,email', ["public_profile"], function(data)
                                  {
                                    
                                    sessionStorage.setItem("user-info",JSON.stringify(data)); 
                                    $.mobile.changePage("municipios.html");

                                  }, function(error)
                                  {
                                    alert("A senha ou usuario inserido está incorreta");
                                  });

                              }, function(error) 
                                {
                                    alert("Não foi possível conectar com facebook");
                                });
                         }); 



                  });

                function onBackButtonTapped() 
                  {
                      //alert( $.mobile.activePage.attr('id') );
                      if( $.mobile.activePage.attr('id') == "municipios" || $.mobile.activePage.attr('id') == "index"  ) 
                        {
                            navigator.app.exitApp();
                        }
                      else 
                        {
                           if($.mobile.activePage.attr('id') == "pre-favorecidos" ||
                              $.mobile.activePage.attr('id') == "pre-fornecedores-detalhes" ||
                              $.mobile.activePage.attr('id') == "pre-fornecedores-itens" ||
                              $.mobile.activePage.attr('id') == "pre-tipos-de-despesas" ||
                              $.mobile.activePage.attr('id') == "ver-favorecidos" ||
                              $.mobile.activePage.attr('id') == "ver-fornecedores-detalhes" ||
                              $.mobile.activePage.attr('id') == "ver-fornecedores-itens" ||
                              $.mobile.activePage.attr('id') == "ver-tipos-despesas") 
                                   {
                                      $.mobile.changePage("menu_principal.html")
                                   }
                               else 
                                   {
                                      
                                      if($.mobile.activePage.attr('id') == "menu_principal") 
                                          {
                                            $.mobile.changePage("municipios.html")    
                                          }
                                      else 
                                          {
                                            window.history.back();       
                                          }
                                      
                                   }
                           
                        }  
                  }
                document.addEventListener("backbutton", onBackButtonTapped, false);   

        </script>

   </div> 
</body>

</html>
